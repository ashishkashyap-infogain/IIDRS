@model IEnumerable<IIDRS.M_BU>

@{
    ViewBag.Title = "Business Unit";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<br />
<br />
<link href="~/Content/Search.css" rel="stylesheet" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/css/bootstrap.css" rel="stylesheet" />
<link href="https://cdn.datatables.net/1.10.22/css/dataTables.bootstrap4.min.css" rel="stylesheet" />
<script src="https://code.jquery.com/jquery-3.5.1.js"></script>
<script src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.10.22/js/dataTables.bootstrap4.min.js"></script>
<script src="~/Scripts/twbsPagination.js" type="text/javascript"></script>


<div style="float:right">
    <button style="float:right" class="btn btn-sm btn-primary rounded-0" id="btnAddRow"><i class="fa fa-address-book"></i>&nbsp;Add</button>
    <br /><br />
</div>

<div class="flexbox">
    <div class="search">
        <div>
            <input type="text" placeholder="Search . . ." required id="Search">
        </div>
    </div>
</div>


<table id="DataTable" class="table table-bordered table-striped table-hover">

    <thead class="thead-dark">
        <tr>
            <th>
                @Html.DisplayNameFor(model => model.BU_NAME)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.BU_TYPE)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.DU_NAME)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.PROJ_ID)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.PROJ_NAME)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.LAST_UPD_BY)
            </th>
            
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {
            <tr class="Search">
                <td>
                    @Html.DisplayFor(modelItem => item.BU_NAME)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.BU_TYPE)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.DU_NAME)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.PROJ_ID)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.PROJ_NAME)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.LAST_UPD_BY)
                </td>
            </tr>
        }
    </tbody>
</table>

<div class="container">
    <nav aria-label="Page navigation">
        <ul class="pagination" id="pagination"></ul>
    </nav>
</div>
<script src="~/scripts/bootstable.js">
   //For SetEditable reference
</script>

<script>
    $('#DataTable').SetEditable({
        columnsEd: "0,1",
        $addButton: $('#btnAddRow'),
        onAdd: function () {
            window.location.reload();
        }
    });
    //for pagination
    $(document).ready(function () {
        let pageSize = 7;
        var visibleRows = $('table#DataTable tbody tr:visible');

        function drawPagination(totalitems) {
            var $pagination = $('#pagination');
            var totalValue = totalitems;
            var toShow = 7;
            var numOfPage = Math.ceil(totalValue / toShow);
            if (numOfPage > 1) {
                var totalPages = numOfPage;
                var currentPage = $pagination.twbsPagination('getCurrentPage');
                $pagination.twbsPagination('destroy');
                $pagination.twbsPagination($.extend({}, {
                    startPage: currentPage,
                    totalPages: totalPages,
                    visiblePages: 7,
                    onPageClick: function (event, page) {
                        refreshPage(event, page);
                    }
                }));
            } else {
                $pagination.twbsPagination('destroy');
            }
        }
        function refreshPage(event, page) {
            var pageStart = (pageSize * page) - pageSize;
            var pageLast = pageSize * page;
            $(visibleRows).hide();
            var currentRows = $(visibleRows).slice(pageStart, pageLast);
            $(currentRows).show();
        }

        drawPagination(visibleRows.length);

    });
    //for search
    function Contains(text_one, text_two) {
        if (text_one.indexOf(text_two) != -1)
            return true;
    }
    $("#Search").keyup(function () {
        var searchtext = $("#Search").val().toLowerCase();
        $(".Search").each(function () {
            if (!Contains($(this).text().toLowerCase(), searchtext)) {
                $(this).hide();
            }
            else {
                $(this).show();
            }
        });
    });
</script>

@*<th>
        @Html.DisplayNameFor(model => model.M_CONTACT)
    </th>*@
@*<th>
        @Html.DisplayNameFor(model => model.M_ORG_EXT)
    </th>*@
@*<td>
        @Html.DisplayFor(modelItem => item.M_CONTACT)
    </td>*@
@*<td>
        @Html.DisplayFor(modelItem => item.M_ORG_EXT)
    </td>
               $('#DataTable').DataTable({
               "columnDefs": [{
                   "targets": [1, 2, 3, 4],
                   "orderable": false,
               }],
               "order": [[0, "asc"]],
               "lengthChange": false,
               "searching": false,
               "paging": false,
               "info": false
           });
*@